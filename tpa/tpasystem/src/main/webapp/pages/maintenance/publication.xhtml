<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:shiro="http://shiro.apache.org/tags"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:f="http://java.sun.com/jsf/core"	
	template="/templates/template.xhtml">
	<ui:define name="metadata">
	</ui:define>
	<ui:define name="breadCrumbComponent">
		<p:breadCrumb id="path_page" style="margin-bottom:3px">
			<p:menuitem value="#{msg['menu_home']}" icon="ui-icon fa fa-home" style="bottom: -3px;left: 3px" url="/home.xhtml" />
			<p:menuitem value="#{msg['menu_maintenance']}" url="#" />
			<p:menuitem value="#{msg['menu_maintenance_publication']}" url="/pages/maintenance/publication.xhtml" />
		</p:breadCrumb>
	</ui:define>
	<ui:define name="content">
		<h:form id="form" style="width:100%;height:98%;border-collapse:collapse;" fullPage="true">
			<p:growl id="msgs" showDetail="true" sticky="true"/>
			
 			<shiro:hasPermission name="#{changeSystemView.system}.MAINTENANCE.MAINTENANCE_PUBLICATION.QUERY">
		        <p:schedule id="schedule" value="#{publicationView.eventModel}" widgetVar="schedule" ignoreTimezone="false" timeZone="GMT+7"  style="width:99%;padding: 5px"
		        	draggable="false" resizable="false" aspectRatio="2">
		 
		            <p:ajax event="eventSelect" listener="#{publicationView.onEventSelect}" update=":#{p:component('eventDetails')}" oncomplete="PF('eventDialog').show();" />
		 
		        </p:schedule>
	        </shiro:hasPermission>

		</h:form>
		<p:dialog widgetVar="eventDialog" header="Event Details" showEffect="clip" hideEffect="clip" modal="true" appendTo="@(body)"
		  	width="75%" closeOnEscape="true">
		    <h:form id="formPublication">
			<p:growl id="msgs" showDetail="true"  life="5000"/>
				<p:panelGrid id="eventDetails">
		        	<p:row>
						<p:column>
				        	<p:panelGrid>
					        	<p:row>
					        		<p:column>
					        			<p:outputLabel value="#{msg['maintenance_code']}" style="font-weight: bold;" />
					        		</p:column>
					        		<p:column>
					       				<h:outputText value="#{publicationView.selected.maintenance_code}" />
					       			</p:column>
					       			<p:column></p:column>
					       			<p:column></p:column>
					        	</p:row>
					        	<p:row>
					        		<p:column>
					        			<p:outputLabel value="#{msg['maintenance_subject']}" style="font-weight: bold;" />
					        		</p:column>
					        		<p:column>
					       				<h:outputText value="#{publicationView.selected.maintenance_subject}" />
					       			</p:column>
					        	</p:row>
					        	<p:row>
					        		<p:column colspan="4">
					        			<p:outputLabel value="#{msg['maintenance_engineering_data']}" style="font-weight: bold;" />
					        		</p:column>
					        	</p:row>
					        	
					        	<p:row>
					        		<p:column>
					        			<p:outputLabel value="#{msg['maintenance_area']}" style="font-weight: bold;" />
					        		</p:column>
					        		<p:column >
							            <h:outputText value="#{publicationView.selected.area}" />
							        </p:column>
									<p:column>
					        			<p:outputLabel value="#{msg['maintenance_subarea']}" style="font-weight: bold;" />
					        		</p:column>
							        <p:column>
							            <h:outputText value="#{publicationView.selected.subarea}" />
							        </p:column>
					        	</p:row>
					        	<p:row>
					        		<p:column>
					        			<p:outputLabel value="#{msg['from']}" style="font-weight: bold;" />
					        		</p:column>
					        		<p:column rendered="#{publicationView.selected.is_daily}">
							            <h:outputText value="#{publicationView.selected.start_date}" >
		              						<f:convertDateTime pattern="dd/MM/yyyy" />
			              		 		</h:outputText>
							        </p:column>
					        		<p:column rendered="#{!publicationView.selected.is_daily}">
							            <h:outputText value="#{publicationView.selected.start_date}" >
		              						<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
			              		 		</h:outputText>
							        </p:column>
									<p:column>
					        			<p:outputLabel value="#{msg['to']}" style="font-weight: bold;" />
					        		</p:column>
							        <p:column rendered="#{publicationView.selected.is_daily}">
							            <h:outputText value="#{publicationView.selected.end_date}" >
		              						<f:convertDateTime pattern="dd/MM/yyyy" />
			              		 		</h:outputText>
							        </p:column>
							        <p:column rendered="#{!publicationView.selected.is_daily}">
							            <h:outputText value="#{publicationView.selected.end_date}" >
		              						<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
			              		 		</h:outputText>
							        </p:column>
					        	</p:row>
					        	
					        	<p:row rendered="#{publicationView.selected.is_daily}">
					        		<p:column>
					        			<p:outputLabel value="#{msg['maintenance_start_hour']}" style="font-weight: bold;" />
					        		</p:column>
					        		<p:column>
							            <h:outputText value="#{publicationView.selected.start_date}" >
		              						<f:convertDateTime pattern="HH:mm:ss" />
			              		 		</h:outputText>
							        </p:column>
									<p:column>
					        			<p:outputLabel value="#{msg['maintenance_end_hour']}" style="font-weight: bold;" />
					        		</p:column>
							        <p:column>
							            <h:outputText value="#{publicationView.selected.end_date}" >
		              						<f:convertDateTime pattern="HH:mm:ss" />
			              		 		</h:outputText>
							        </p:column>
					        	</p:row>
					        	
					        	<p:row>
									<p:column>
					        			<p:outputLabel value="#{msg['maintenance_actual_end_date']}" style="font-weight: bold;" />
					        		</p:column>
					        		<p:column colspan="3">
										<h:outputText value="#{publicationView.selected.actual_end_date}" >
		              						<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
			              		 		</h:outputText>
					        			
									
							        </p:column>
					        	</p:row>
					        	
					        	<p:row>
									<p:column>
					        			<p:outputLabel value="#{msg['maintenance_daily']}" style="font-weight: bold;" />
					        		</p:column>
					        		<p:column colspan="3">
					        			<p:selectBooleanCheckbox disabled="true" value="#{publicationView.selected.is_daily}" />
							        </p:column>
					        	</p:row>
								<p:row>
									<p:column>
					        			<p:outputLabel value="#{msg['maintenance_operator_comment']}" style="font-weight: bold;" />
					        		</p:column>
					        		<p:column colspan="3">
							            <p:inputTextarea cols="100" readonly="true" value="#{publicationView.selected.operator_comments}" />
							        </p:column>
					        	</p:row>
				        	</p:panelGrid>
						</p:column>		        	
		        	</p:row>
					<p:row>
						<p:column>

							<p:dataTable widgetVar="w_work_detail" id="work_detail_table"
								var="operator" value="#{publicationView.selected.operator_data}"
								reflow="true" 
								style="margin-bottom:20px;border-collapse:collapse"
								paginator="true" rows="5" rowsPerPageTemplate="5,10,15,20,25">

								<f:facet name="header">
									<p:outputPanel style="height:25px">
										<p:outputLabel style="float:center" value="#{msg['maintenance_operator_data']}" />
									</p:outputPanel>
								</f:facet>

								<p:column style="border: 1px solid #a8a8a8 !important" headerText="#{msg['maintenance_area']}">
									<h:outputText value="#{operator.area}" />
								</p:column>

								<p:column style="border: 1px solid #a8a8a8 !important" headerText="#{msg['maintenance_subarea']}">
									<h:outputText value="#{operator.subarea}" />
								</p:column>
								<p:column style="border: 1px solid #a8a8a8 !important" headerText="#{msg['maintenance_capacity_affected']}">
									<h:outputText style="float:right" value="#{operator.capacity_affected}" >
										<f:convertNumber groupingUsed="true" minFractionDigits="3" maxFractionDigits="3" />
									</h:outputText>
								</p:column>

							</p:dataTable>


						</p:column>
					</p:row>
		 			<p:row>
						<p:column>
				        	<p:panelGrid columns="3">			
		 			
					            <p:commandButton id="close" value="Close" oncomplete="PF('eventDialog').hide();" />
					        </p:panelGrid>
				        </p:column>
			        </p:row>
		        </p:panelGrid>
			</h:form>
	    </p:dialog>    

	</ui:define>


</ui:composition>
